/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/FlexConfiguration","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/VersionInfo"],function(e,t,r,n,o,i,s,l,a,c,p){"use strict";var u={isPersonalized(r){function n(t){e.error(t);return Promise.reject(t)}function o(e){return e.getFileType()==="change"}function i(e,r,n){var o=r.map(function(e){return e.id||e.getId()});var i=n.getSelector();var s=t.getControlIdBySelector(i,e);return o.includes(s)}function l(e,t){return Array.isArray(e)&&e.length>0?e.includes(t.getChangeType()):true}if(!r.selectors||r.selectors.length===0){return n("At least one control ID has to be provided as a parameter")}var p=r.selectors[0].appComponent||c.getAppComponentForControl(r.selectors[0]);if(!p){return n("App Component could not be determined")}var u=s.getChangePersistenceForControl(p);return u.getChangesForComponent({currentLayer:a.USER,includeCtrlVariants:true}).then(function(e){return e.filter(o).filter(i.bind(this,p,r.selectors)).filter(l.bind(this,r.changeTypes)).length>0}.bind(this))},waitForChanges(e){var t;var r;if(e.element){t=[{selector:e.element}];r=e.element}else if(e.selectors){t=e.selectors.map(function(e){return{selector:e}});[r]=e.selectors}else if(e.complexSelectors){t=e.complexSelectors;r=e.complexSelectors[0].selector}return l.createForSelector(r).waitForChangesToBeApplied(t)},isFlexSupported(e){return!!c.getAppComponentForControl(e.element)},hasVariantManagement(e){return r.belongsToVariantManagement(e.element)},getFlexReference(e){return n.getFlexReferenceForControl(e.element)},getConfiguredFlexServices(){return o.getFlexibilityServices()},getFlexVersion(e){return i.getByReference(e.reference)?.version},async getFeedbackInformation(e){const t=this.getConfiguredFlexServices()[0].connector;const r=c.getAppDescriptor(e.rootControl);const o=await p.load();const i=n.getAppIdFromManifest(r);const s=n.getAppVersionFromManifest(r);return{appId:i,appVersion:s,connector:t,version:o.version}}};return u});
//# sourceMappingURL=FlexRuntimeInfoAPI.js.map