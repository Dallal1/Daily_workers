/*
 * ! OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Lib","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/getVariantAuthor","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Layer"],function(e,a,n,t,r,i){"use strict";const s={};s.variants=function(r){r.flexObjects.forEach(e=>{if(e.getFileType()==="ctrl_variant"){e.setAuthor(t(e,r.storageResponse.authors))}});const s=(r.storageResponse.changes.variants||[]).map(function(e){return e.fileName}).concat(r.externalData.filter(function(e){return e.getFileType()==="ctrl_variant"}).map(function(e){return e.getId()}));var c={runtimeOnlyData:{flexObjects:[]}};var l=r.storageResponse.changes.variants;var f=r.storageResponse.changes.variantDependentControlChanges.filter(function(e){var a=e.isChangeOnStandardVariant;if(a!==undefined&&a!==null){return a}return!/id_\d{13}_\d*_flVariant/.test(e.variantReference)});var u=l.concat(f);u.forEach(function(t){var r=t.fileType==="ctrl_variant"?t.variantManagementReference:t.variantReference;if(r&&!s.includes(r)){var l=e.getResourceBundleFor("sap.ui.fl");var f=n.createFlVariant({id:r,variantManagementReference:r,variantName:l.getText("STANDARD_VARIANT_TITLE"),layer:i.BASE,user:a.DEFAULT_AUTHOR,reference:t.reference});c.runtimeOnlyData.flexObjects.push(f);s.push(r)}});return c};s.uiChanges=function(e){const a=r.createEmptyDependencyMap();e.flexObjects.forEach(n=>{if(n.isA("sap.ui.fl.apply._internal.flexObjects.UIChange")&&!n.getVariantReference()){r.addChangeAndUpdateDependencies(n,e.componentId,a)}});return{runtimeOnlyData:{liveDependencyMap:a}}};return s});
//# sourceMappingURL=InitialPrepareFunctions.js.map