{"version":3,"file":"ObjectStorageConnector.js","names":["sap","ui","define","hash","_uniqBy","each","merge","Layer","Utils","Version","BaseConnector","StorageUtils","ObjectStorageUtils","mFeatures","isKeyUser","isVariantSharingEnabled","isProductiveSystem","isCondensingEnabled","isContextSharingEnabled","isVersioningEnabled","logonUser","loadDataFromStorage","mPropertyBag","aFlexObjects","forEachObjectInStorage","mFlexObject","push","changeDefinition","then","shouldChangeBeDeleted","oChangeDefinition","bDelete","selectorIds","selector","indexOf","id","changeTypes","changeType","setFlexObjectCreation","oFlexObject","iCounter","creation","nCreationTimestamp","Date","now","toISOString","calculateCacheKey","reduce","sKey","getTime","forEveryMapInArrayInMap","mMap","fnCallback","sOuterKey","aArray","forEach","mInnerMap","sInnerKey","oContent","handleCondenseCreate","oCreateInfos","aReturn","oFlexObjectFileContent","sChangeId","createFlexKey","condensedChanges","find","oCurrentFlexObject","getId","fileName","getCreation","setCreation","key","value","handleCondenseUpdate","oUpdateInfos","aCondenserChanges","oUpdatedFlexObject","some","handleCondenseReorder","oReorderInfos","aCondensedChanges","sFileType","aChangeIds","length","aFilteredFlexObjects","filter","getFileType","iIndex","oNextFlexObject","oCurrentDate","oNextDate","oNewDateTime","handleCondenseDelete","oDeleteInformation","aPromises","Object","values","this","storage","removeItem","bind","ObjectStorageConnector","undefined","layers","loadFlexData","reference","aVersionChain","versions","getVersionChain","call","version","includes","aSortedFilteredFlexObjects","sortFlexObjects","mGroupedFlexObjects","getGroupedFlexObjects","aResponses","filterAndSortResponses","cacheKey","write","loadFeatures","sDraftVersionId","layer","CUSTOMER","flexObjects","getDraftId","aUpdatedFlexObjects","createFlexObjectKey","vUpdatedFlexObject","_itemsStoredAsObjects","JSON","stringify","setItem","response","update","flexObject","vFlexObject","vSetResponse","Promise","resolve","reset","aResponse","remove","vRemoveResponse","loadVariantsAuthors","reject","getFlexInfo","getAllFlexObjects","isResetEnabled","condense","oCondenseInformation","aObjectsToSet","concat","create","reorder","delete","keys","oItemToSet","oFileContent","convertToFileContent","all","aDraftFilenames","map","change","sId","aVersions","load","oDraftVersion","oVersion","isDraft","filenames","Number","Draft","createDefaultFileName","activatedAt","activatedBy","fileType","title","parentVersion","Original","vVersion","sVersionId","findVersion","sort","a","b","activate","oActivateVersion","sNewVersionId","discardDraft","aFiles","aDraftFiles","aDiscardPromises"],"sources":["ObjectStorageConnector-dbg.js"],"mappings":";;;;;AAMAA,IAAIC,GAAGC,OAAO,CACb,wBACA,mCACA,qBACA,sBACA,kBACA,kBACA,gCACA,2CACA,2CACA,2DACE,SACFC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,aAEA,MAAMC,EAAY,CACjBC,UAAW,KACXC,wBAAyB,KACzBC,mBAAoB,MACpBC,oBAAqB,KACrBC,wBAAyB,MACzBC,oBAAqB,KACrBC,UAAW,gBAGZ,SAASC,EAAoBC,GAC5B,IAAIC,EAAe,GAEnB,OAAOX,EAAmBY,uBAAuBF,EAAc,SAASG,GACvEF,EAAaG,KAAKD,EAAYE,iBAC/B,GAAGC,KAAK,WACP,OAAOL,CACR,EACD,CAEA,SAASM,EAAsBP,EAAcQ,GAC5C,IAAIC,EAAU,KAEd,GAAIT,EAAaU,YAAa,CAC7B,GAAIF,EAAkBG,SAAU,CAC/BF,EAAUT,EAAaU,YAAYE,QAAQJ,EAAkBG,SAASE,KAAO,CAC9E,KAAO,CACNJ,EAAU,KACX,CACD,CAEA,GAAIA,GAAWT,EAAac,YAAa,CACxCL,EAAUT,EAAac,YAAYF,QAAQJ,EAAkBO,aAAe,CAC7E,CAEA,OAAON,CACR,CAEA,SAASO,EAAsBC,EAAaC,GAC3C,IAAKD,EAAYE,SAAU,CAI1B,IAAIC,EAAqBC,KAAKC,MAAQJ,EACtCD,EAAYE,SAAW,IAAIE,KAAKD,GAAoBG,aACrD,CACA,OAAON,CACR,CAEA,SAASO,EAAkBvB,GAC1B,OAAOpB,EAAKoB,EAAawB,OAAO,SAASC,EAAMT,GAC9C,OAAOS,EAAO,IAAIL,KAAKJ,EAAYE,UAAUQ,SAC9C,EAAG,IACJ,CAaA,SAASC,EAAwBC,EAAMC,GACtC/C,EAAK8C,EAAM,SAASE,EAAWC,GAC9BA,EAAOC,QAAQ,SAASC,GAEvBnD,EAAKmD,EAAW,SAASC,EAAWC,GACnCN,EAAWM,EAAUD,EACtB,EACD,EACD,EACD,CAEA,SAASE,EAAqBC,EAActC,GAC3C,IAAIuC,EAAU,GACd,IAAIrB,EAAW,EAEfU,EAAwBU,EAAc,SAASE,EAAwBC,GACtE,IAAIf,EAAOpC,EAAmBoD,cAAcD,GAC5C,IAAIxB,EAAcjB,EAAa2C,iBAAiBC,KAAK,SAASC,GAC7D,OAAOA,EAAmBC,UAAYN,EAAuBO,QAC9D,GAEA,IAAK9B,EAAY+B,cAAe,CAE/B,IAAI5B,EAAqBC,KAAKC,MAAQJ,EACtCA,IACAD,EAAYgC,YAAY,IAAI5B,KAAKD,GAAoBG,cACtD,CACAgB,EAAQnC,KAAK,CAAC8C,IAAKxB,EAAMyB,MAAOlC,GACjC,GAEA,OAAOsB,CACR,CAEA,SAASa,EAAqBC,EAAcC,GAE3C,IAAIf,EAAU,GACdX,EAAwByB,EAAc,SAASR,EAAoBJ,GAClE,IAAIf,EAAOpC,EAAmBoD,cAAcD,GAC5C,IAAIc,EACJD,EAAkBE,KAAK,SAASX,GAC/B,GAAIA,EAAmBC,UAAYL,EAAW,CAC7Cc,EAAqBV,EACrB,OAAO,IACR,CACD,GACAN,EAAQnC,KAAK,CAAC8C,IAAKxB,EAAMyB,MAAOI,GACjC,GAEA,OAAOhB,CACR,CAEA,SAASkB,EAAsBC,EAAeC,GAC7C,IAAIpB,EAAU,GACdxD,EAAK2E,EAAe,SAASE,EAAWC,GACvC,GAAIA,EAAWC,OAAS,EAAG,CAC1B,MACD,CAOA,IAAIC,EAAuBJ,EAAkBK,OAAO,SAAS/C,GAC5D,OAAOA,EAAYgD,gBAAkBL,CACtC,GACAG,EAAqB9B,QAAQ,SAAShB,EAAaiD,GAClD,GAAIL,EAAWjD,QAAQK,EAAY6B,UAAY,GAAKoB,EAASH,EAAqBD,OAAS,EAAG,CAC7F,IAAIK,EAAkBJ,EAAqBG,EAAS,GACpD,IAAIE,EAAe,IAAI/C,KAAKJ,EAAY+B,eACxC,IAAIqB,EAAY,IAAIhD,KAAK8C,EAAgBnB,eAEzC,GAAImB,GAAmBC,GAAgBC,EAAW,CACjD,IAAIC,EAAeF,EAAazC,UAAY,EAC5CwC,EAAgBlB,YAAY,IAAI5B,KAAKiD,GAAc/C,eACnD,IAAIG,EAAOpC,EAAmBoD,cAAcyB,EAAgBrB,SAC5DP,EAAQnC,KAAK,CAAC8C,IAAKxB,EAAMyB,MAAOgB,GACjC,CACD,CACD,EACD,GAEA,OAAO5B,CACR,CAEA,SAASgC,EAAqBC,GAC7B,IAAIC,EAAY,GAChB,GAAID,EAAoB,CACvBE,OAAOC,OAAOH,GAAoBvC,QAAQ,SAAS4B,GAClDA,EAAW5B,QAAQ,SAASQ,GAC3B,IAAIf,EAAOpC,EAAmBoD,cAAcD,GAC5CgC,EAAUrE,KAAKwE,KAAKC,QAAQC,WAAWpD,GACxC,EAAEqD,KAAKH,MACR,EAAEG,KAAKH,MACR,CAEA,OAAOH,CACR,CAcA,IAAIO,EAAyBhG,EAAM,CAAC,EAAGI,EAAmF,CAMzHyF,QAASI,UACTC,OAAQ,CACP,OAYD,kBAAMC,CAAanF,GAClB,MAAMC,QAAqBF,EAAoB,CAC9C8E,QAASD,KAAKC,QACdO,UAAWpF,EAAaoF,YAGzB,MAAMC,QAAsBT,KAAKU,SAASC,gBAAgBC,KAAKZ,KAAM5E,EAAcA,EAAayF,SAChG,MAAM1B,EAAuB9D,EAAa+D,OAAQ/C,GACjDA,EAAYwE,UAAYR,WAAaI,EAAcK,SAASzE,EAAYwE,UAEzE,MAAME,EAA6BtG,EAAauG,gBAAgB7B,GAChE,MAAM8B,EAAsBxG,EAAayG,sBAAsBH,GAC/D,MAAMI,EAAa1G,EAAa2G,uBAAuBH,GACvD,GAAIE,EAAWjC,OAAQ,CACtBiC,EAAW,GAAGE,SAAWzE,EAAkBmE,EAC5C,CACA,OAAOI,CACR,EAKA,WAAMG,CAAMlG,GACX,MAAMT,QAAkBqF,KAAKuB,eAC7B,IAAIC,EACJ,GAAI7G,EAAUM,qBAAuBG,EAAaqG,QAAUpH,EAAMqH,SAAU,CAE3EtG,EAAaoF,UAAYpF,EAAauG,YAAY,IAAInB,UACtDgB,QAAwBxB,KAAKU,SAASkB,WAAWhB,KAAKZ,KAAM5E,EAC7D,CAEA,IAAIkE,EAAS,EACb,MAAMuC,EAAsB,GAC5B,IAAK,MAAMxF,KAAejB,EAAauG,YAAa,CACnD,GAAIH,EAAiB,CACpBnF,EAAYwE,QAAUW,CACvB,CACA,MAAM1E,EAAOpC,EAAmBoH,oBAAoBzF,GACpD,MAAMsC,EAAqBvC,EAAsBC,IAAeiD,GAChE,MAAMyC,EAAqB/B,KAAKC,QAAQ+B,sBAAwBrD,EAAqBsD,KAAKC,UAAUvD,SAC9FqB,KAAKC,QAAQkC,QAAQrF,EAAMiF,GACjCF,EAAoBrG,KAAKmD,EAC1B,CAEA,MAAO,CACNyD,SAAUP,EAEZ,EAKA,MAAAQ,CAAOjH,GACN,IAAIiB,EAAcjB,EAAakH,WAC/B,IAAIxF,EAAOpC,EAAmBoH,oBAAoB1G,EAAakH,YAC/D,IAAIC,EAAcvC,KAAKC,QAAQ+B,sBAAwB3F,EAAc4F,KAAKC,UAAU7F,GACpF,IAAImG,EAAexC,KAAKC,QAAQkC,QAAQrF,EAAMyF,GAE9C,OAAOE,QAAQC,QAAQF,EACxB,EAKA,KAAAG,CAAMvH,GACL,OAAOV,EAAmBY,uBAAuB,CAChD2E,QAASD,KAAKC,QACdO,UAAWpF,EAAaoF,UACxBiB,MAAOrG,EAAaqG,OAClB,SAASlG,GACX,GAAII,EAAsBP,EAAcG,EAAYE,kBAAmB,CACtE,OAAOgH,QAAQC,QAAQ1C,KAAKC,QAAQC,WAAW3E,EAAY+C,MAAM5C,KAAK,WACrE,MAAO,CACNyC,SAAU5C,EAAYE,kBAAkB0C,UAAY5C,EAAYE,kBAAkBQ,GAEpF,EACD,CACD,EAAEkE,KAAKH,OACNtE,KAAK,SAASkH,GACd,MAAO,CACNR,SAAUQ,EAAUxD,OAAO,SAASxD,GACnC,QAASA,CACV,GAEF,EACD,EAKA,MAAAiH,CAAOzH,GACN,IAAI0B,EAAOpC,EAAmBoH,oBAAoB1G,EAAakH,YAC/DtC,KAAKC,QAAQC,WAAWpD,GACxB,IAAIgG,EAAkB9C,KAAKC,QAAQC,WAAWpD,GAE9C,OAAO2F,QAAQC,QAAQI,EACxB,EAKA,YAAAvB,GACC,OAAOkB,QAAQC,QAAQ/H,EACxB,EAKA,mBAAAoI,GACC,OAAON,QAAQO,OAAO,yCACvB,EAKA,WAAAC,CAAY7H,GACXA,EAAa6E,QAAUD,KAAKC,QAC5B,OAAOvF,EAAmBwI,kBAAkB9H,GAAcM,KAAK,SAASL,GACvE,MAAO,CACN8H,eAAgB9H,EAAa6D,OAAS,EAExC,EACD,EAKA,cAAMkE,CAAShI,GAGd,IAAIiI,EAAuBjI,EAAauG,YACxC,IAAI2B,EAAgB,GAEpBA,EAAgBA,EAAcC,OAAO9F,EAAqB4F,EAAqBG,OAAQpI,IACvFkI,EAAgBA,EAAcC,OAAO/E,EAAqB6E,EAAqBhB,OAAQjH,EAAa2C,mBACpGuF,EAAgBA,EAAcC,OAAO1E,EAAsBwE,EAAqBI,QAASrI,EAAa2C,mBACtGuF,EAAgBpJ,EAAQoJ,EAAe,OAEvC,IAAIzD,EAAY,GAChB,IAAI+C,EAAY,GAChB/C,EAAYA,EAAU0D,OAAO5D,EAAqBiB,KAAKZ,KAAMqD,EAAqBK,SAElF,MAAM/I,QAAkBqF,KAAKuB,eAC7B,IAAIC,EACJ,GACC7G,EAAUM,qBACPG,EAAaqG,QAAUpH,EAAMqH,WAC3B2B,EAAqBG,QAAU1D,OAAO6D,KAAKN,EAAqBG,QAAQtE,SAAW,GACpFmE,EAAqBhB,QAAUvC,OAAO6D,KAAKN,EAAqBhB,QAAQnD,SAAW,GACnFmE,EAAqBI,SAAW3D,OAAO6D,KAAKN,EAAqBI,SAASvE,SAAW,GACxF,CAEDsC,QAAwBxB,KAAKU,SAASkB,WAAWhB,KAAKZ,KAAM5E,EAC7D,CAEAkI,EAAcjG,QAAQ,SAASuG,GAC9B,IAAIC,EAAeD,EAAWrF,MAAMuF,uBACpC,GAAItC,EAAiB,CACpBqC,EAAahD,QAAUW,CACxB,CACAoB,EAAUpH,KAAKqI,GACf,IAAItB,EAAcvC,KAAKC,QAAQ+B,sBAAwB6B,EAAe5B,KAAKC,UAAU2B,GACrFhE,EAAUrE,KAAKwE,KAAKC,QAAQkC,QAAQyB,EAAWtF,IAAKiE,GACrD,EAAEpC,KAAKH,OACP,OAAOyC,QAAQsB,IAAIlE,GAAWnE,KAAK,WAClC,OAAO+G,QAAQC,QAAQ,CAACN,SAAUQ,GACnC,EACD,EAKAlC,SAAU,CACT,gBAAMkB,CAAWxG,GAChB,IAAI4I,EAAkB,GACtB,GAAI5I,EAAa2C,iBAAkB,CAClCiG,EAAkB5I,EAAa2C,iBAAiBkG,IAAKC,GAAmBA,EAAOC,IAChF,KAAO,CACNH,EAAkB5I,EAAauG,YAAYsC,IAAK3B,GAAuBA,EAAWnE,SACnF,CAEA,MAAMiG,QAAkBpE,KAAKU,SAAS2D,KAAKzD,KAAKZ,KAAM5E,GACtD,IAAIkJ,EAAgBF,EAAUpG,KAAMuG,GAAaA,EAASC,SAC1D,GAAIF,EAAe,CAClB,GAAIlJ,EAAa2C,iBAAkB,CAClCuG,EAAcG,UAAY,EAC3B,CACAH,EAAcG,UAAYT,EAAgBT,OAAOe,EAAcG,UAChE,KAAO,CAENH,EAAgB,CACfzD,QAAStG,EAAQmK,OAAOC,MACxB1I,GAAI3B,EAAMsK,sBAAsB,WAChCJ,QAAS,KACTK,YAAa,GACbC,YAAa,GACbC,SAAU,UACVtD,MAAOpH,EAAMqH,SACbsD,MAAO,GACPxE,UAAWpF,EAAaoF,UACxBiE,UAAWT,GAEZ,GAAI5I,EAAa6J,gBAAkB1K,EAAQmK,OAAOQ,SAAU,CAC3DZ,EAAcW,cAAgB7J,EAAa6J,aAC5C,CACD,CAEA,MAAMnI,EAAOpC,EAAmBoD,cAAc,GAAGwG,EAAcrI,MAC/D,MAAMkJ,EAAWnF,KAAKC,QAAQ+B,sBAAwBsC,EAAgBrC,KAAKC,UAAUoC,SAC/EtE,KAAKC,QAAQkC,QAAQrF,EAAMqI,GAEjC,OAAOb,EAAcrI,EACtB,EAWA,qBAAM0E,CAAgBvF,EAAcgK,GACnC,MAAM3E,EAAgB,GACtB,MAAM4E,EAAc,CAACD,EAAYb,IAAaa,IAAeb,EAAS1D,QACtE,MAAMuD,QAAkBpE,KAAKU,SAAS2D,KAAKzD,KAAKZ,KAAM5E,GAEtDgK,IAAehB,EAAUpG,KAAMuG,IAAcA,EAASC,UAAUvI,GAEhE,MAAOmJ,EAAY,CAClB,MAAMb,EAAWH,EAAUpG,KAAKqH,EAAYlF,KAAKE,UAAW+E,IAC5D3E,EAAcjF,KAAK+I,EAAStI,IAC5BmJ,EAAab,EAASU,aACvB,CAEA,OAAOxE,CACR,EAKA,UAAM4D,CAAKjJ,GACV,MAAMC,QAAqBF,EAAoB,CAC9C8E,QAASD,KAAKC,QACdO,UAAWpF,EAAaoF,YAGzB,OAAOnF,EAAa+D,OAAQ/C,GAAgBA,EAAY0I,WAAa,WAAWO,KAAK,CAACC,EAAGC,KACxF,GAAID,EAAEf,QAAS,CACd,OAAQ,CACT,CACA,GAAIgB,EAAEhB,QAAS,CACd,OAAO,CACR,CACA,OAAOe,EAAEV,YAAcW,EAAEX,YAAc,GAAK,CAAC,EAE/C,EAKA,cAAMY,CAASrK,GACd,MAAMT,QAAkBqF,KAAKuB,eAC7B,MAAM6C,QAAkBpE,KAAKU,SAAS2D,KAAKzD,KAAKZ,KAAM5E,GACtD,IAAIsK,EAAmBtB,EAAUpG,KAAMuG,GAAaA,EAAS1D,UAAYzF,EAAayF,SACtF,GAAI6E,EAAkB,CAErB,IAAKA,EAAiBlB,QAAS,CAC9BkB,EAAiBzJ,GAAK3B,EAAMsK,sBAAsB,WAClDc,EAAiBT,cAAgB7J,EAAayF,OAC/C,CACD,KAAO,CAEN,MAAM8E,EAAgBrL,EAAMsK,sBAAsB,WAClDc,EAAmB,CAClB7E,QAAS8E,EACT1J,GAAI0J,EACJZ,SAAU,UACVtD,MAAOpH,EAAMqH,SACblB,UAAWpF,EAAaoF,UAE1B,CAEA,GAAIpF,EAAayF,UAAYtG,EAAQmK,OAAOC,MAAO,CAClD,MAAML,EAAgBF,EAAUpG,KAAMuG,GAAaA,EAASC,SAC5D,GAAIF,EAAe,OACZtE,KAAKU,SAASkF,aAAahF,KAAKZ,KAAM5E,EAC7C,CACD,CACA,MAAM0B,EAAOpC,EAAmBoD,cAAc4H,EAAiBzJ,IAC/DyJ,EAAiBV,MAAQ5J,EAAa4J,MACtCU,EAAiBb,YAAc,IAAIpI,KAAKA,KAAKC,OAAOC,cACpD+I,EAAiBZ,YAAcnK,EAAUO,UACzCwK,EAAiBlB,QAAU,MAC3BkB,EAAiB7E,QAAU6E,EAAiBzJ,UACrCyJ,EAAiBjB,UACxB,MAAMlC,EAAcvC,KAAKC,QAAQ+B,sBAAwB0D,EAAmBzD,KAAKC,UAAUwD,GAC3F1F,KAAKC,QAAQkC,QAAQrF,EAAMyF,GAC3B,OAAOmD,CACR,EAKA,kBAAME,CAAaxK,GAClBA,EAAa6E,QAAUD,KAAKC,QAC5B,MAAMmE,QAAkBpE,KAAKU,SAAS2D,KAAKzD,KAAKZ,KAAM5E,GACtD,MAAMoG,EAAkB4C,EAAUpG,KAAMuG,GAAaA,EAASC,UAAUvI,GACxE,IAAKuF,EAAiB,CACrB,OAAOiB,QAAQO,OAAO,wBACvB,CAEA,MAAM6C,QAAe1K,EAAoBC,GACzC,MAAM0K,EAAcD,EAAOzG,OAAQ/C,GAAgBA,EAAYwE,UAAYW,GAE3E,MAAM8C,EAAgBF,EAAUpG,KAAMuG,GAAaA,EAAStI,KAAOuF,GACnEsE,EAAYtK,KAAK8I,GAEjB,MAAMyB,EAAmBD,EAAY7B,IAAK5H,IACzC,IAAIS,EAAOpC,EAAmBoD,cAAczB,EAAY8B,UAAY9B,EAAYJ,IAChF,OAAO+D,KAAKC,QAAQC,WAAWpD,EAAK,SAG/B2F,QAAQsB,IAAIgC,EACnB,KAIF,OAAO3F,CACR"}