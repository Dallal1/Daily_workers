/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Element","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/apply/_internal/flexState/changes/UIChangesState"],function(e,n,a,t){"use strict";function i(e){var t;var i=document.querySelector(".sapUiComponentContainer");i=Array.isArray(i)?i:[i];i.some(function(i){var s=n.getElementById(i.id);var r=s&&s.getComponentInstance();if(r&&a.getFlexReferenceForControl(r)===e){t=r;return true}});return t}function s(n,a){var t=i(a.sComponentName);for(var s in n._mChangesEntries){var o=n._mChangesEntries[s];a.mChangesEntries[s]={mDefinition:o.convertToFileContent(),aControlsDependencies:[],aDependencies:[]};if(o._aDependentSelectorList&&t){o._aDependentSelectorList.forEach(function(n){var i={bPresent:!!e.bySelector(n,t),aAppliedChanges:[],aFailedChangesJs:[],aFailedChangesXml:[],aNotApplicableChanges:[]};a.mControlData[n.id]=i})}}r(a.sComponentName,a)}function r(e,n){const a=t.getCompleteDependencyMap(e);for(var i in a){var s=a[i];n.mChangesEntries[i].aControlsDependencies=s.controlsDependencies;n.mChangesEntries[i].aDependencies=s.dependencies}}function o(e,n,a,t,i){if(i){a[t]=i;a[t].map(function(a){if(!(a in e[n])){e[n].push(a)}})}}function l(e,n){var a=e.getCustomData();var t=[];a.forEach(function(e){var a=e.getKey();if(a.startsWith(n)){t.push(a.replace(n,""))}});return t}function p(e,a){for(var t in e.getDependencyMapForComponent().mChanges){var i={bPresent:false,aAppliedChanges:[],aFailedChangesJs:[],aFailedChangesXml:[],aNotApplicableChanges:[]};var s=n.getElementById(t);if(s){i.bPresent=true;o(a,"aAppliedChanges",i,"aAppliedChanges",l(s,"sap.ui.fl.appliedChanges."));o(a,"aFailedChanges",i,"aFailedChangesJs",l(s,"sap.ui.fl.failedChanges.js."));o(a,"aFailedChanges",i,"aFailedChangesXml",l(s,"sap.ui.fl.failedChanges.xml."));o(a,"aNotApplicableChanges",i,"aNotApplicableChanges",l(s,"sap.ui.fl.notApplicableChanges."))}a.mControlData[t]=i}}return function(e){if(!e){return}var n={sVersion:"1",bIsInvestigationExport:true,mControlData:{},aAppliedChanges:[],aFailedChanges:[],aNotApplicableChanges:[],mChangesEntries:{},mVariantsChanges:{},sComponentName:e._mComponent.name};s(e,n);p(e,n);return n}});
//# sourceMappingURL=extractChangeDependencies.js.map