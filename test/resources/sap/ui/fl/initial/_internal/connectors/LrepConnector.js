/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/Utils","sap/ui/dom/includeScript","sap/base/util/restricted/_pick"],function(e,t,s,n){"use strict";const i={DATA:"/flex/data/",MODULES:"/flex/modules/",SETTINGS:"/flex/settings",VARIANTS_AUTHORS:"/variants/authors/"};let r={};return{layers:["ALL"],xsrfToken:undefined,settings:undefined,_loadModules(e){return new Promise(function(t,n){s(e,undefined,t,n)})},_addClientInfo(e){var s=t.getUrlParameter("sap-client");if(!e&&s){e={}}if(s){e["sap-client"]=s}},loadFeatures(t){if(this.settings){return Promise.resolve(this.settings)}var s={};this._addClientInfo(s);var n=e.getUrl(i.SETTINGS,t,s);return e.sendRequest(n,"GET",{initialConnector:this}).then(function(e){e.response.isVariantAdaptationEnabled=!!e.response.isPublicLayerAvailable;e.response.isContextSharingEnabled=true;e.response.isLocalResetEnabled=true;return e.response})},loadFlexData(t){if(t.cacheKey==="<NO CHANGES>"){return Promise.resolve()}var s=n(t,["version","allContexts","adaptationId"]);this._addClientInfo(s);e.addSAPLogonLanguageInfo(s);var a;if(t.appDescriptor&&t.appDescriptor["sap.app"]){a=t.appDescriptor["sap.app"].id}if(t.preview){t.reference=t.preview.reference;s.upToLayerType=t.preview.maxLayer}r=s;var o=e.getUrl(i.DATA,t,s);return e.sendRequest(o,"GET",{initialConnector:this,xsrfToken:this.xsrfToken,siteId:t.siteId,sAppDescriptorId:a}).then(function(n){var r=n.response;if(n.etag){r.cacheKey=n.etag}else if(t.cacheKey){r.cacheKey=t.cacheKey}r.changes=r.changes.concat(r.compVariants||[]);if(r.settings){this.settings=r.settings;this.settings.isVariantAdaptationEnabled=!!this.settings.isPublicLayerAvailable;this.settings.isContextSharingEnabled=true;this.settings.isLocalResetEnabled=true}if(!r.loadModules){return r}var a=e.getUrl(i.MODULES,t,s);return this._loadModules(a).then(function(){return r})}.bind(this))},loadVariantsAuthors(t){const s=e.getUrl(i.VARIANTS_AUTHORS,t,r);return e.sendRequest(s,"GET",{initialConnector:this}).then(function(e){return e.response})}}});
//# sourceMappingURL=LrepConnector.js.map