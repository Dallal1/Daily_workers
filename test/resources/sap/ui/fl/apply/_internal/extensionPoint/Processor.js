/*!
* OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/extensionPoint/Registry","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/changes/ExtensionPointState","sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/base/SyncPromise","sap/base/util/merge","sap/ui/base/DesignTime"],function(e,n,t,i,r,o,a,s,u){"use strict";var l;function f(e,n,t,i,r){return r(e,true).then(function(r){r.forEach(function(e,r){n.splice(t+r+i,0,e)});e.index+=i;return r.length-1})}function g(e,n,t){var i=[];var r=[];var o=0;var s;t.forEach(function(t,a){if(t._isExtensionPoint){t.targetControl=e.targetControl;t.aggregationName=e.aggregationName;t.fragmentId=e.fragmentId;t.index=a;if(s){s._nextSibling=t}s=t;t.referencedExtensionPoint=e;i.push(function(){return f(t,r,a,o,n).then(function(e){o+=e})})}else{r.push(t)}});if(i.length>0){return i.reduce(function(e,n){return e.then(n)},a.resolve()).then(function(){return r})}return a.resolve(r)}function d(e,n){var a=r.getAppComponentForControl(e.targetControl);var u={};var f=s({defaultContent:[]},e);u.appComponent=a;u.modifier=o;u.viewId=e.view.getId();u.componentId=a.getId();return l.registerExtensionPoint(f).then(t.initialize.bind(t,u)).then(i.enhanceExtensionPointChanges.bind(i,u,e)).then(l.createDefaultContent.bind(this,e,n,d)).then(l.addDefaultContentToExtensionPointInfo.bind(this,f,n))}l={oExtensionPointRegistry:undefined,oRegistryPromise:Promise.resolve(),registerExtensionPoint(e){if(u.isDesignModeEnabled()){n.registerExtensionPoint(e)}return a.resolve()},createDefaultContent(e,n,t,i){if(i.length===0){return e.createDefault().then(g.bind(undefined,e,t)).then(function(t){if(!n){t.forEach(function(n,t){o.insertAggregation(e.targetControl,e.aggregationName,n,e.index+t,e.view)});e.ready(t)}return t})}return a.resolve([])},addDefaultContentToExtensionPointInfo(e,n,t){if(!n){e.defaultContent=e.defaultContent.concat(t)}return t},applyExtensionPoint(n){var t=d(n,false);e.addPreConditionForInitialChangeApplying(t);return t}};return l});
//# sourceMappingURL=Processor.js.map