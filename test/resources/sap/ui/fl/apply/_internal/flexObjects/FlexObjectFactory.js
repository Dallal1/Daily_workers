/* !
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/base/util/ObjectPath","sap/ui/fl/apply/_internal/flexObjects/AppDescriptorChange","sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/ControllerExtensionChange","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/FlVariant","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/apply/_internal/flexObjects/getVariantAuthor","sap/ui/fl/registry/Settings","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,a,r,i,o,c,s,l,p,u,f,O){"use strict";var g={BASE_FLEX_OBJECT:i,COMP_VARIANT_OBJECT:a,FL_VARIANT_OBJECT:o,CONTROLLER_EXTENSION:r,APP_DESCRIPTOR_CHANGE:n,UI_CHANGE:s};function y(e){if(e.fileType==="variant"){return g.COMP_VARIANT_OBJECT}else if(e.fileType==="ctrl_variant"){return g.FL_VARIANT_OBJECT}else if(e.changeType==="codeExt"){return g.CONTROLLER_EXTENSION}else if(e.appDescriptorChange){return g.APP_DESCRIPTOR_CHANGE}return g.UI_CHANGE}function m(e){const t=e.type||e.changeType;const n=e.fileName||e.id||O.createDefaultFileName(t);const a=e.user||(!f.isDeveloperLayer(e.layer)?p.getInstanceOrUndef()&&p.getInstanceOrUndef().getUserId():undefined);return{id:n,adaptationId:e.adaptationId,layer:e.layer,content:e.content,texts:e.texts,supportInformation:{service:e.ODataService,oDataInformation:e.oDataInformation,command:e.command,compositeCommand:e.compositeCommand,generator:e.generator,sourceChangeFileName:e.support&&e.support.sourceChangeFileName,sourceSystem:e.sourceSystem,sourceClient:e.sourceClient,originalLanguage:e.originalLanguage,user:a},flexObjectMetadata:{changeType:t,reference:e.reference,packageName:e.packageName,projectId:e.projectId}}}var C={};C.createFromFileContent=function(e,n,a){var r=Object.assign({},e);var o=n||y(r);if(!o){throw new Error("Unknown file type")}r.support=Object.assign({generator:"FlexObjectFactory.createFromFileContent"},r.support||{});var s=o.getMappingInfo();var l=i.mapFileContent(r,s);var p=Object.entries(l).reduce(function(e,n){t.set(n[0].split("."),n[1],e);return e},{});var u=new o(p);if(a){u.setProperty("state",c.LifecycleState.PERSISTED)}return u};C.createUIChange=function(e){e.packageName||="$TMP";var t=m(e);t.layer||=e.isUserDependent?u.USER:f.getCurrentLayer();t.selector=e.selector;t.jsOnly=e.jsOnly;t.variantReference=e.variantReference;t.isChangeOnStandardVariant=e.isChangeOnStandardVariant;t.fileType=e.fileType||"change";return new s(t)};C.createAppDescriptorChange=function(e){e.compositeCommand||=e.support&&e.support.compositeCommand;var t=m(e);return new n(t)};C.createControllerExtensionChange=function(e){e.generator||="FlexObjectFactory.createControllerExtensionChange";e.changeType="codeExt";e.content={codeRef:e.codeRef};var t=m(e);t.flexObjectMetadata.moduleName=e.moduleName;t.controllerName=e.controllerName;return new r(t)};C.createFlVariant=function(e){e.generator||="FlexObjectFactory.createFlVariant";var t=m(e);t.variantManagementReference=e.variantManagementReference;t.variantReference=e.variantReference;t.contexts=e.contexts;t.texts={variantName:{value:e.variantName,type:"XFLD"}};const n=new o(t);n.setAuthor(l(n,e.authors));return n};C.createCompVariant=function(e,n){e.generator||="FlexObjectFactory.createCompVariant";e.user=t.get("support.user",e);var r=m(e);r.variantId=e.variantId||r.id;r.contexts=e.contexts;r.favorite=e.favorite;r.persisted=e.persisted;r.persistencyKey=e.persistencyKey||t.get("selector.persistencyKey",e);if(e.layer===u.VENDOR||e.layer===u.CUSTOMER_BASE){r.favorite=true}if(e.executeOnSelection!==undefined){r.executeOnSelection=e.executeOnSelection}else{r.executeOnSelection=r.content&&(r.content.executeOnSelect||r.content.executeOnSelection)}const i=new a(r);i.setAuthor(l(i,n));return i};return C});
//# sourceMappingURL=FlexObjectFactory.js.map