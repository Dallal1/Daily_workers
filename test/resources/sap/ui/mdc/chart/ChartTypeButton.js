/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/OverflowToolbarButton","sap/m/ButtonRenderer","sap/ui/base/ManagedObjectObserver","sap/m/library","sap/m/IllustratedMessage","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/model/Filter","sap/ui/model/json/JSONModel"],(e,t,a,s,o,r,i,n,c)=>{"use strict";const{PlacementType:p}=s;let l,h,d,u,b,m,y;const _=e.extend("sap.ui.mdc.chart.ChartTypeButton",{metadata:{library:"sap.ui.mdc",associations:{chart:{type:"sap.ui.mdc.Chart",multiple:false}}},renderer:t});_.prototype.init=function(){e.prototype.init.apply(this,arguments);this.bindProperty("icon","$chart>/ChartTypeInfo/icon");this.bindProperty("tooltip","$chart>/ChartTypeInfo/text");this.bindProperty("text","$chart>/ChartTypeInfo/text");this.attachPress(this.displayChartTypes.bind(this))};_.prototype._updateChart=function(e){if(e){const t=new c;t.setProperty("/ChartTypeInfo",e.getChartTypeInfo());this.setModel(t,"$chart");this._oObserver=new a(a=>{if(a.name==="chartType"){t.setProperty("/ChartTypeInfo",e.getChartTypeInfo())}});this._oObserver.observe(e,{aggregations:["items"],properties:["chartType"]})}else{this.setModel(null,"$chart");if(this._oObserver){this._oObserver.disconnect();this._oObserver.destroy();delete this._oObserver}}};_.prototype.setChart=function(e){this.setAssociation("chart",e);this._updateChart(e);return this};_.prototype._getChart=function(){let e;const t=this.getChart();if(t){e=r.getElementById(t)}return e};_.mMatchingIcon={bar:"sap-icon://horizontal-bar-chart",bullet:"sap-icon://horizontal-bullet-chart",bubble:"sap-icon://bubble-chart",column:"sap-icon://vertical-bar-chart",combination:"sap-icon://business-objects-experience",dual_bar:"sap-icon://horizontal-bar-chart",dual_column:"sap-icon://vertical-bar-chart",dual_combination:"sap-icon://business-objects-experience",dual_horizontal_combination:"sap-icon://business-objects-experience",dual_horizontal_stacked_combination:"sap-icon://business-objects-experience",dual_line:"sap-icon://line-chart",dual_stacked_bar:"sap-icon://full-stacked-chart",dual_stacked_column:"sap-icon://vertical-stacked-chart",dual_stacked_combination:"sap-icon://business-objects-experience",donut:"sap-icon://donut-chart",heatmap:"sap-icon://heatmap-chart",horizontal_stacked_combination:"sap-icon://business-objects-experience",line:"sap-icon://line-chart",pie:"sap-icon://pie-chart",scatter:"sap-icon://scatter-chart",stacked_bar:"sap-icon://full-stacked-chart",stacked_column:"sap-icon://vertical-stacked-chart",stacked_combination:"sap-icon://business-objects-experience",treemap:"sap-icon://Chart-Tree-Map",vertical_bullet:"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart",waterfall:"sap-icon://vertical-waterfall-chart",horizontal_waterfall:"sap-icon://horizontal-waterfall-chart"};_.prototype.displayChartTypes=function(e){const t=this._getChart();const a=e.getSource();if(!t||!a){return}if(!this.oReadyPromise){this.oReadyPromise=new Promise(e=>{if(l){e(true)}else{sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/SearchField","sap/m/StandardListItem","sap/ui/core/InvisibleText","sap/ui/Device"],(t,a,s,o,r,n)=>{l=t;h=a;d=s;u=o;b=r;m=n;if(!y){i.load({name:"sap.ui.mdc"}).then(()=>{y=i.getResourceBundleFor("sap.ui.mdc");e(true)})}else{e(true)}})}})}this.oReadyPromise.then(()=>{if(!this.oPopover){this.oPopover=this._createPopover(t);this.oPopover.attachAfterOpen(function(e){const t=this.oPopover.getContent()[1];const a=t.getItems().filter(function(e){return e.getSelected()})[0];a.focus()}.bind(this));this.oPopover.attachAfterClose(()=>{this.oPopover.destroy();delete this.oPopover});return this.oPopover.openBy(a)}else if(this.oPopover){this.oPopover.close()}})};_.prototype._createPopover=function(e){const t=new u({title:"{$chartTypes>text}",icon:"{$chartTypes>icon}",selected:"{$chartTypes>selected}"});const a=new h({mode:"SingleSelectMaster",noData:new o({title:y.getText("chart.NO_CHART_TYPES_AVAILABLE"),description:y.getText("chart.NO_CHART_TYPES_AVAILABLE_ACTION"),illustrationType:s.IllustratedMessageType.AddDimensions}),items:{path:"$chartTypes>/AvailableChartTypes",template:t},selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){const a=t.mParameters.listItem.getBinding("title");if(a){const t=a.getContext();if(t){const a=t.getObject();if(a&&a.key){sap.ui.require(["sap/ui/mdc/flexibility/Chart.flexibility"],t=>{e.getEngine().createChanges({control:e,key:"Type",state:{properties:{chartType:a.key}}}).then(t=>{e.getControlDelegate().requestToolbarUpdate(e)})})}}}}i.close()}});const r=new d({placeholder:y.getText("chart.CHART_TYPE_SEARCH"),liveChange:function(t){if(e){this._triggerSearchInPopover(t,a)}}.bind(this)});const i=new l({id:e.getId()+"-btnChartTypePopover",placement:p.VerticalPreferredBottom,contentWidth:"25rem"});if(!m.system.phone){i.setSubHeader(r)}else{i.addContent(r)}const n=new c;const _=this._getChart().getAvailableChartTypes();const f=this._getChart().getChartType();_.forEach(e=>{e.selected=e.key===f});n.setProperty("/AvailableChartTypes",_);i.setModel(n,"$chartTypes");if(m.system.desktop){const e=new b({text:y.getText("chart.CHART_TYPELIST_TEXT")});i.setShowHeader(false);i.addContent(e);i.addAriaLabelledBy(e)}else{i.setTitle(y.getText("chart.CHART_TYPELIST_TEXT"))}i.addContent(a);if(a.getItems().length<7){r.setVisible(false)}return i};_.prototype._triggerSearchInPopover=function(e,t){if(!e||!t){return}const a=e.getParameter("newValue");let s=[];if(a){s=new n("text","Contains",a)}t.getBinding("items").filter(s)};_.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this.oPopover){this.oPopover.destroy();this.oPopover=null}if(this._oObserver){this._oObserver.disconnect();this._oObserver.destroy();delete this._oObserver}};return _});
//# sourceMappingURL=ChartTypeButton.js.map