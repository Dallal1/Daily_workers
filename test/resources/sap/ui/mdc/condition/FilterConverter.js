/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/base/Log"],(e,t,r,i)=>{"use strict";const n={createConditionTypesMapFromFilterBar:function(e,t){const r={};for(const i in e){if(t){const e=t._getPropertyByName(i);let n;if(e&&e.typeConfig){n=e.typeConfig.typeInstance}else{const e=t._getFilterField(i);if(e){const t=e.getFormatOptions();if(t.originalDateType){n=t.originalDateType}else{n=t.valueType}}}r[i]={type:n}}}return r},createFilters:function(o,s,l,a){let f,p,u,c,h,d,g,y;const F=[];const P=function(e,t,r){const i="L1";let n,o,s;if(e.sPath&&e.sPath.indexOf(r)>-1){n=e.sPath.split(r);if(n.length===2){o=n[0];s=n[1];e.sPath=i+"/"+s;return{path:o,operator:t,variable:i}}else{throw new Error("FilterConverter: not supported binding "+e.sPath)}}return false};const v=function(e){const t=P(e,r.Any,"*/");if(t){return t}else{return P(e,r.All,"+/")}};for(const r in o){p=[];u=[];y=null;const n=o[r];if(r==="$search"){continue}let l;let P=true;let O;if(s){if(s[r]){l=s[r].type;P=s[r].caseSensitive;O=s[r].baseType;if(!l){i.warning("FilterConverter","Not able to retrieve the type of path '"+r+"!")}}}for(f=0;f<n.length;f++){g=n[f];c=e.getOperator(g.operator);if(!c){continue}try{h=c.getModelFilter(g,r,l,P,O)}catch(e){if(e){i.error("FilterConverter",e)}else{i.error("FilterConverter","Not able to convert the condition for path '"+r+"' into a filter! The type is missing!")}continue}if(!c.exclude){if(h.sPath==="$search"){continue}const e=/^\*(.+)\*$/.exec(h.sPath);if(e){const r=e[1].split(",");for(let e=0;e<r.length;e++){p.push(new t({path:r[e],operator:h.sOperator,value1:h.oValue1,caseSensitive:a}))}continue}y=v(h);p.push(h)}else{y=v(h);u.push(h)}}h=undefined;if(p.length===1){h=p[0]}else if(p.length>1){h=new t({filters:p,and:false})}if(h){u.unshift(h)}d=undefined;if(u.length===1){d=u[0]}else if(u.length>1){d=new t({filters:u,and:true})}if(y){y.condition=d;d=new t(y)}if(d){F.push(d)}}if(F.length===1){h=F[0]}else if(F.length>1){h=new t({filters:F,and:true})}else{h=null}i.info("FilterConverter",n.prettyPrintFilters(h));return h},prettyPrintFilters:function(e){let t;if(!e){return"no filters set"}if(e._bMultiFilter){t="";const{bAnd:r}=e;e.aFilters.forEach((e,i,o)=>{t+=n.prettyPrintFilters(e);if(o.length-1!=i){t+=r?" and ":" or "}},this);return"("+t+")"}else{if(e.sOperator===r.Any||e.sOperator===r.All){t=e.sPath+" "+e.sOperator+" "+n.prettyPrintFilters(e.oCondition)}else{if(e.bCaseSensitive===false){t="tolower("+e.sPath+") "+e.sOperator+" tolower('"+e.oValue1+"')"}else{t=e.sPath+" "+e.sOperator+" '"+e.oValue1+"'"}if([r.BT,r.NB].indexOf(e.sOperator)>=0){t+="...'"+e.oValue2+"'"}}return t}}};return n},true);
//# sourceMappingURL=FilterConverter.js.map